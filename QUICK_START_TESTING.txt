â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  PHASE 5C-2: QUICK START TESTING REFERENCE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TEST GROUP: oc_cd4b98905e12ec0cb68adc529440e623

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STEP 1: SETUP (2 min)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Clear devtools:
  curl -X POST http://localhost:3000/devtools/api/clear

Verify clean:
  curl -s http://localhost:3000/devtools/api/stats | jq .totalEvents

Open devtools UI:
  http://localhost:3000/devtools

(Optional) Start monitoring:
  ./scripts/monitor-phase5c.sh

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STEP 2: SEND Q1 (2 min)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

In Feishu, send to test group:

  @bot What are the key principles of OKR setting?

EXPECTED:
  âœ“ Agent responds with detailed explanation
  âœ“ Mentions objectives, key results, measurable goals
  âœ“ Devtools shows agent_call event with tokens
  âœ“ No memory context on first message (expected)

CHECK:
  curl -s 'http://localhost:3000/devtools/api/events?limit=1' | \
    jq '.[] | {tokens_in: .metadata.tokens.input, tokens_out: .metadata.tokens.output}'

EXPECTED OUTPUT:
  {
    "tokens_in": 150-250,
    "tokens_out": 500-1000
  }

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STEP 3: SEND Q2 (3 min) - KEY TEST
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

In Feishu, send to test group:

  @bot How can I apply those principles to my engineering team?

EXPECTED:
  âœ“ Response references Q1 ("As discussed", "Based on principles we talked about")
  âœ“ Applies OKR principles to engineering context
  âœ“ Shows understanding of Q1 content
  âœ“ Devtools shows HIGHER input token count (memory context added)

CHECK:
  curl -s 'http://localhost:3000/devtools/api/events?limit=2' | \
    jq -r '.[] | .metadata.tokens.input'

EXPECTED OUTPUT:
  Q2 tokens: 350-450  (increase of ~200 from Q1)
  Q1 tokens: 150-250

VERIFY RESPONSE REFERENCES Q1:
  Look for keywords: "principles", "objectives", "key results", "discussed", etc.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STEP 4: VERIFY MEMORY (3 min)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Check what's in Supabase:
  bun run scripts/check-phase5c-memory.ts

EXPECTED OUTPUT:
  âœ“ Total messages: 4 (Q1, A1, Q2, A2)
  âœ“ All with same conversation_id: feishu:oc_cd4b98905e12ec0cb68adc529440e623:root_xxx
  âœ“ All with same user_id: ou_xxx (mentioned user, not sender)
  âœ“ Proper role alternation: user â†’ assistant â†’ user â†’ assistant

EXAMPLE OUTPUT:
  âœ… Found 4 messages
  
  ðŸ“Œ Conversation: feishu:oc_cd4b98905e12ec0cb68adc529440e623:root_xxx
     Messages: 4
     Span: 17:30:45 â†’ 17:30:52
     Users in conversation: 1
       â€¢ ou_xyz: 4 messages
  
     Message sequence:
     1. [user] 17:30:45
        What are the key principles of OKR setting?
     2. [assistant] 17:30:46
        Here are the key principles: [detailed explanation]
     3. [user] 17:30:50
        How can I apply those principles to my engineering team?
     4. [assistant] 17:30:52
        As we discussed before, here's how to apply them to engineering...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
STEP 5: (OPTIONAL) SEND Q3 FOR DEEPER VALIDATION (2 min)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

In Feishu, send:

  @bot What metrics should I track to measure success?

EXPECTED:
  âœ“ Response references both Q1 and Q2
  âœ“ Understands full context of conversation
  âœ“ Input tokens EVEN HIGHER (600-700)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUCCESS CRITERIA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

MINIMUM (for pass):
  âœ“ Q1 receives response
  âœ“ Q2 receives response that references Q1
  âœ“ Both responses appear in devtools

STANDARD (expected):
  âœ“ All of minimum
  âœ“ Q2 token count > Q1 token count
  âœ“ Messages saved to Supabase with correct format
  âœ“ All messages have same conversation_id

FULL (comprehensive):
  âœ“ All of standard
  âœ“ Q3 sent and response shows multi-turn understanding
  âœ“ Token progression: Q1 < Q2 < Q3
  âœ“ User ID extracted from mentions (check server logs)
  âœ“ All messages have same user_id in database
  âœ“ Proper role alternation in memory

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
TROUBLESHOOTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

No response?
  â€¢ Check server is running: curl http://localhost:3000/health
  â€¢ Check bot mention format: @bot or @_user_2
  â€¢ Check LLM API keys are set
  â€¢ Check server logs for errors

Tokens not increasing on Q2?
  â€¢ Verify messages are in Supabase: bun run scripts/check-phase5c-memory.ts
  â€¢ Check logs for: "Loaded N messages for conversation"
  â€¢ Verify Supabase is connected (not using InMemory fallback)

Response doesn't reference Q1?
  â€¢ Check message count in Supabase
  â€¢ Verify same conversation_id for all messages
  â€¢ Check memory load limit in code

User ID wrong in database?
  â€¢ Check server logs: "Extracted mentioned user ID: ou_xxx"
  â€¢ Verify message format: must be @bot (not @user_2 text)
  â€¢ Check mentions array in webhook

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
AFTER TESTING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

If PASSED:
  bd close feishu_assistant-lra --reason "Phase 5c-2 passed - multi-turn memory working"
  bd update feishu_assistant-sbi --status in_progress  (move to Phase 5d)

If ISSUES:
  bd create "Issue: ..." --deps discovered-from:feishu_assistant-lra
  Document findings and blockers

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
For detailed guide: see PHASE_5C_EXECUTION_GUIDE.md
For full plan: see PHASE_5C_MEMORY_VALIDATION.md
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
