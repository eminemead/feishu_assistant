$ bun server.ts
[info]: [ "client ready" ]
âš ï¸ [Auth] Supabase URL or ANON_KEY not configured. RLS features will be disabled.
âš ï¸ [Auth] SUPABASE_JWT_SECRET not configured. JWT generation will fail.
âš ï¸ [Auth] Supabase credentials not configured. RLS features will be disabled.
[info]: [ "event-dispatch is ready" ]
ğŸ“‹ [Startup] Starting server initialization...
ğŸ“‹ [Startup] Mode: Subscription (WebSocket)
ğŸ“‹ [Startup] Step 1: Initializing WebSocket connection...
[info]: [ "[ws]", "receive events or callbacks through persistent connection only available in self-build & Feishu app, Configured in:\n        Developer Console(å¼€å‘è€…åå°) \n          ->\n        Events and Callbacks(äº‹ä»¶ä¸å›è°ƒ)\n          -> \n        Mode of event/callback subscription(è®¢é˜…æ–¹å¼)\n          -> \n        Receive events/callbacks through persistent connection(ä½¿ç”¨ é•¿è¿æ¥ æ¥æ”¶äº‹ä»¶/å›è°ƒ)" ]
âœ… [Startup] Step 1: WebSocket connection established
ğŸ“‹ [Startup] Ready to receive Feishu events
ğŸ“‹ [Startup] Step 2: Starting HTTP server...
âœ… [Startup] Step 2: HTTP server started on port 3000
âœ¨ [Startup] Server is ready to accept requests
ğŸ“Š [Startup] Health check: curl http://localhost:3000/health
[info]: [ "[ws]", "ws client ready" ]
ğŸ“¨ [WebSocket] Event received: im.message.receive_v1
ğŸ“¨ [WebSocket] Event data: {
  "schema": "2.0",
  "event_id": "0288da9a0c5eed7a8533a959d31294ec",
  "token": "",
  "create_time": "1763707917824",
  "event_type": "im.message.receive_v1",
  "tenant_key": "2de1f662118f575d",
  "app_id": "cli_a6af6b76c6f0d013",
  "message": {
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "chat_type": "group",
    "content": "{\"text\":\"@_user_1 new behavior check\"}",
    "create_time": "1763707917508",
    "mentions": [
      {
        "id": {
          "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
          "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
          "user_id": ""
        },
        "key": "@_user_1",
        "name": "Evi",
        "tenant_key": "2de1f662118f575d"
      }
    ],
    "message_id": "om_x100b5d348e1bd4a8c4ed14cf0474269",
    "message_type": "text",
    "parent_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "root_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "thread_id": "omt_1a7b7fe7f08f1b85",
    "update_time": "1763707917589",
    "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 15_3_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.268 Safari/537.36 Lark/7.56.5 LarkLocale/zh_CN ttnet SDK-Version/7.56.19"
  },
  "sender": {
    "sender_id": {
      "open_id": "ou_db4d1d08c4fcd3f1f4c253eab32ff580",
      "union_id": "on_80d62273b85f0904e27382a59cc1f730",
      "user_id": "xiaofei.yin"
    },
    "sender_type": "user",
    "tenant_key": "2de1f662118f575d"
  }
}
ğŸ¤– [WebSocket] Bot User ID: cli_a6af6b76c6f0d013
ğŸ‘¤ [Auth] Extracted user ID: ou_db4d1d08c4fcd3f1f4c253eab32ff580
ğŸ“© [WebSocket] Message details: chatId=oc_cd4b98905e12ec0cb68adc529440e623, messageId=om_x100b5d348e1bd4a8c4ed14cf0474269, chatType=group
ğŸ” [WebSocket] Mentions array: [
  {
    "id": {
      "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
      "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
      "user_id": ""
    },
    "key": "@_user_1",
    "name": "Evi",
    "tenant_key": "2de1f662118f575d"
  }
]
ğŸ” [WebSocket] Found 1 mention(s) in group message
âœ… [WebSocket] Bot mention detected via mentions array
ğŸ‘¥ [WebSocket] Processing group mention: "@_user_1 new behavior check..."
Handling app mention
ğŸ“¤ [Card] Creating and sending streaming card to chat_id:oc_cd4b98905e12ec0cb68adc529440e623
âœ… [Card] Created streaming card: cardId=7575067822893993166, elementId=md_07917934
ğŸ“¨ [Card] Sending card message with cardId: 7575067822893993166
ğŸ“¨ [Card] Sending as thread reply to message: om_x100b5d348e1bd4a8c4ed14cf0474269
âœ… [Card] Card sent successfully: messageId=om_x100b5d348e2404a8c2370199367a7fc, cardId=7575067822893993166
[Thread] Fetching thread history: rootId=om_x100b5edb3c20e4a0c291114d498450e, messageId=om_x100b5d348e1bd4a8c4ed14cf0474269
âŒ Failed to fetch thread after 1 attempt: Thread fetch timeout after 5000ms
âš ï¸ Proceeding with empty thread context (falling back to current message only)
âš ï¸ [Thread] Thread history empty or fetch failed, using current message only
[Thread] Fallback: Starting fresh with current message only
[Thread] Processing with 1 message(s)
[FeishuMention] Generating response...
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ¤– [Model] Using fallback model: Google Gemini 2.5 Flash (Paid (reliable, no rate limits))
[Manager] Received query: "@_user_1 new behavior check"
[Manager] Starting stream for query: "@_user_1 new behavior check" with primary model
[Manager] Memory context: conversationId=feishu:oc_cd4b98905e12ec0cb68adc529440e623:om_x100b5edb3c20e4a0c291114d498450e, userId=user:ou_db4d1d08c4fcd3f1f4c253eab32ff580, feishuUserId=ou_db4d1d08c4fcd3f1f4c253eab32ff580
[Manager] Stream created, starting to read textStream...
[Cache] MISS
ğŸ”„ [Card] Updating card element: cardId=7575067822893993166, elementId=md_07917934, sequence=1, contentLength=1
ğŸ”„ [Card] Updating card element: cardId=7575067822893993166, elementId=md_07917934, sequence=2, contentLength=46
[Manager] Finished reading textStream. Total chunks: 26, Final text length: 46
[Manager] Final result received: {
  text: "N/A",
  textLength: 0,
  accumulatedLength: 46,
  usage: {
    input: undefined,
    output: undefined,
    total: undefined,
  },
}
[Manager] Query handled directly (no handoff): "@_user_1 new behavior check"
[Manager] Returning final text (length=46)
[FeishuMention] Response generated (length=46): "æˆ‘å·²å°†æ‚¨çš„æŸ¥è¯¢è½¬æ¥ç»™OKR Reviewerä¸“å®¶ï¼Œä»–ä»¬å°†ååŠ©æ‚¨å¤„ç†å…³äºæ–°è¡Œä¸ºæ£€æŸ¥çš„ç›¸å…³äº‹å®œã€‚..."
[FeishuMention] Finalizing card with suggestions. cardId=7575067822893993166, result length=46
ğŸ¯ [CardSuggestions] Finalizing card with follow-ups: cardId=7575067822893993166, contentLength=46
ğŸ¯ [CardSuggestions] Generating follow-up suggestions...
ğŸ”„ [Followups] Generating 3 follow-up questions for response: "æˆ‘å·²å°†æ‚¨çš„æŸ¥è¯¢è½¬æ¥ç»™OKR Reviewerä¸“å®¶ï¼Œä»–ä»¬å°†ååŠ©æ‚¨å¤„ç†å…³äºæ–°è¡Œä¸ºæ£€æŸ¥çš„ç›¸å…³äº‹å®œã€‚..."
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ”„ [Followups] LLM raw response (first 300 chars): "[
  {"text": "æ–°è¡Œä¸ºæ£€æŸ¥çš„å…·ä½“è¯„ä¼°æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸", "type": "recommendation"},
  {"text": "è”ç³»OKR Reviewerç¡®è®¤æäº¤ææ–™æ¸…å•", "type": "action"}
]..."
ğŸ”„ [Followups] Extracted JSON (first 200 chars): "[
  {"text": "æ–°è¡Œä¸ºæ£€æŸ¥çš„å…·ä½“è¯„ä¼°æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸", "type": "recommendation"},
  {"text": "è”ç³»OKR Reviewerç¡®è®¤æäº¤ææ–™æ¸…å•", "type": "action"}
]..."
âœ… [Followups] Generated 3 follow-up options with metadata
ğŸ¯ [CardSuggestions] generateFollowupQuestions returned 3 followups
ğŸ¯ [CardSuggestions] Formatting 3 suggestions as markdown...
ğŸ¯ [CardSuggestions] Updating card element with suggestions...
ğŸ”„ [Card] Updating card element: cardId=7575067822893993166, elementId=md_07917934, sequence=3, contentLength=194
âœ… [CardSuggestions] Card updated with 3 text-based suggestions
ğŸ¯ [CardSuggestions] Disabling streaming mode...
âœ… [CardSuggestions] Streaming mode disabled
ğŸ”˜ [CardSuggestions] Sending buttons in separate message (Hypothesis 1)...
ğŸ”˜ [FollowupButtons] Sending 3 buttons in separate message...
ğŸ”˜ [FollowupButtons] Creating card via CardKit...
ğŸ”˜ [FollowupButtons] Card created: 7575067903906778309
ğŸ”˜ [FollowupButtons] Sending as thread reply to rootId=om_x100b5d348e1bd4a8c4ed14cf0474269...
âš ï¸ [WebSocket] Duplicate event ignored: 0288da9a0c5eed7a8533a959d31294ec
ğŸ”˜ [FollowupButtons] API response: {
  "code": 0,
  "data": {
    "body": {
      "content": "{\"title\":\"Suggestions\",\"elements\":[[{\"tag\":\"img\",\"image_key\":\"img_v3_02ad_e19fca1f-912a-450e-95de-3c229091b53g\"},{\"tag\":\"text\",\"text\":\"è¯·å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬å®¢æˆ·ç«¯ï¼Œä»¥æŸ¥çœ‹å†…å®¹\"},{\"tag\":\"text\",\"text\":\"\"}]]}"
    },
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "create_time": "1763707937289",
    "deleted": false,
    "message_id": "om_x100b5d348cdd5c80c114f2bbe681419",
    "msg_type": "interactive",
    "parent_id": "om...
ğŸ”˜ [FollowupButtons] isSuccess=true, code=0, has message_id=true
âœ… [FollowupButtons] Successfully sent buttons message: om_x100b5d348cdd5c80c114f2bbe681419
âœ… [CardSuggestions] Buttons sent in separate message: om_x100b5d348cdd5c80c114f2bbe681419
[FeishuMention] Card finalized with suggestions (buttons: om_x100b5d348cdd5c80c114f2bbe681419)
ğŸ”˜ [CardAction] Card action trigger received
ğŸ”˜ [CardAction] Action data: {
  "schema": "2.0",
  "event_id": "64030e2382236066b20b0b9d0873d0d3",
  "token": "c-4b4029b6cc0c4dc9baaa81c45d0382bc9c5e403b",
  "create_time": "1763707946213447",
  "event_type": "card.action.trigger",
  "tenant_key": "2de1f662118f575d",
  "app_id": "cli_a6af6b76c6f0d013",
  "operator": {
    "tenant_key": "2de1f662118f575d",
    "user_id": "xiaofei.yin",
    "open_id": "ou_db4d1d08c4fcd3f1f4c253eab32ff580",
    "union_id": "on_80d62273b85f0904e27382a59cc1f730"
  },
  "action": {
    "value": "\"å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸\"",
    "tag": "button"
  },
  "host": "im_message",
  "context": {
    "open_message_id": "om_x100b5d348cdd5c80c114f2bbe681419",
    "open_chat_id": "oc_cd4b98905e12ec0cb68adc529440e623"
  }
}
ğŸ”˜ [CardAction] Button clicked: ""å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸""
ğŸ”˜ [CardAction] Extracted context: chatId=oc_cd4b98905e12ec0cb68adc529440e623, rootId=om_x100b5d348cdd5c80c114f2bbe681419
ğŸ”˜ [ButtonFollowup] Processing button click as new query: buttonValue=""å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸"", chatId=oc_cd4b98905e12ec0cb68adc529440e623, rootId=om_x100b5d348cdd5c80c114f2bbe681419
ğŸ’¬ [ButtonFollowup] Routing to message handler: ""å»ºè®®å‡†å¤‡ç›¸å…³è¡Œä¸ºè®°å½•ä»¥ä¾¿å®¡æ ¸""
Handling new message: oc_cd4b98905e12ec0cb68adc529440e623 om_x100b5d348cdd5c80c114f2bbe681419
ğŸ“¤ [Card] Creating and sending streaming card to chat_id:oc_cd4b98905e12ec0cb68adc529440e623
âœ… [Card] Created streaming card: cardId=7575067945618771147, elementId=md_07946121
ğŸ“¨ [Card] Sending card message with cardId: 7575067945618771147
ğŸ“¨ [Card] Sending as thread reply to message: om_x100b5d348cdd5c80c114f2bbe681419
âœ… [Card] Card sent successfully: messageId=om_x100b5d348c640900c3fb80ee6b2f8e0, cardId=7575067945618771147
âŒ Failed to fetch thread after 1 attempt: Thread fetch timeout after 5000ms
âš ï¸ Proceeding with empty thread context (falling back to current message only)
[Manager] Received query: "[non-text message]"
[Manager] Starting stream for query: "[non-text message]" with primary model
[Manager] Memory context: conversationId=feishu:oc_cd4b98905e12ec0cb68adc529440e623:om_x100b5d348cdd5c80c114f2bbe681419, userId=user:ou_db4d1d08c4fcd3f1f4c253eab32ff580, feishuUserId=ou_db4d1d08c4fcd3f1f4c253eab32ff580
[Manager] Stream created, starting to read textStream...
14 |   constructor({
15 |     name: name14,
16 |     message,
17 |     cause
18 |   }) {
19 |     super(message);
         ^
AI_InvalidPromptError: Invalid prompt: messages must not be empty
      cause: undefined,
     prompt: {
  system: "<system_context>\nYou are part of a multi-agent system called AI SDK Agents, designed to make agent coordination and execution easy. This system uses two primary abstractions: **Agents** and **Handoffs**. An agent encompasses instructions and tools and can hand off a conversation to another agent when appropriate. Handoffs are achieved by calling a handoff function, generally named `handoff_to_agent`. Transfers between agents are handled seamlessly in the background; do not mention or draw attention to these transfers in your conversation with the user.\n</system_context>\n\n<tool_calling_guidelines>\nWhen you need to call multiple tools, call them ALL at once using parallel tool calling.\n</tool_calling_guidelines>\n\nYou are a Feishu/Lark AI assistant that routes queries to specialist agents. Most user queries will be in Chinese (ä¸­æ–‡).\n\nè·¯ç”±è§„åˆ™ï¼ˆæŒ‰ä»¥ä¸‹é¡ºåºåº”ç”¨ï¼‰ï¼š\n1. OKR Reviewer: è·¯ç”±å…³äºOKRã€ç›®æ ‡ã€å…³é”®ç»“æœã€ç»ç†è¯„å®¡ã€æŒ‡æ ‡è¦†ç›–ç‡(has_metric percentage)ã€è¦†ç›–ç‡(è¦†ç›–ç‡)çš„æŸ¥è¯¢\n2. Alignment Agent: è·¯ç”±å…³äºå¯¹é½(alignment)ã€å¯¹é½ã€ç›®æ ‡å¯¹é½çš„æŸ¥è¯¢\n3. P&L Agent: è·¯ç”±å…³äºæŸç›Š(profit & loss)ã€P&Lã€æŸç›Šã€åˆ©æ¶¦ã€äºæŸã€EBITçš„æŸ¥è¯¢\n4. DPA PM Agent: è·¯ç”±å…³äºDPAã€æ•°æ®å›¢é˜Ÿ(data team)ã€AEã€DAçš„æŸ¥è¯¢\n5. Fallback: å¦‚æœæ²¡æœ‰åŒ¹é…çš„ä¸“å®¶ï¼Œä½¿ç”¨ç½‘ç»œæœç´¢(searchWebå·¥å…·)æˆ–æä¾›æœ‰ç”¨çš„æŒ‡å¯¼\n\nROUTING RULES (apply in this order):\n1. OKR Reviewer: Route queries about OKR, objectives, key results, manager reviews, has_metric percentage, or è¦†ç›–ç‡\n2. Alignment Agent: Route queries about alignment, å¯¹é½, or ç›®æ ‡å¯¹é½\n3. P&L Agent: Route queries about profit & loss, P&L, æŸç›Š, åˆ©æ¶¦, äºæŸ, or EBIT\n4. DPA PM Agent: Route queries about DPA, data team, AE, or DA\n5. Fallback: If no specialist matches, use web search (searchWeb tool) or provide helpful guidance\n\nGENERAL GUIDELINES:\n- Do not tag users. ä¸è¦@ç”¨æˆ·ã€‚\n- Current date is: 2025-11-21\n- Format your responses using Markdown syntax (Lark Markdown format), which will be rendered in Feishu cards.\n- Always route to the most appropriate specialist agent when their domain is mentioned.\n- Use web search for general queries that don't match any specialist.\n- Most queries will be in Chinese - understand Chinese query semantics for better routing.\n\nAVAILABLE SPECIALISTS:\n- OKR Reviewer (okr_reviewer): For OKR metrics, manager reviews, has_metric percentage analysis / ç”¨äºOKRæŒ‡æ ‡ã€ç»ç†è¯„å®¡ã€æŒ‡æ ‡è¦†ç›–ç‡åˆ†æ\n- Alignment Agent (alignment_agent): For alignment tracking (under development) / ç”¨äºå¯¹é½è·Ÿè¸ªï¼ˆå¼€å‘ä¸­ï¼‰\n- P&L Agent (pnl_agent): For profit & loss analysis (under development) / ç”¨äºæŸç›Šåˆ†æï¼ˆå¼€å‘ä¸­ï¼‰\n- DPA PM Agent (dpa_pm): For product management tasks (under development) / ç”¨äºäº§å“ç®¡ç†ä»»åŠ¡ï¼ˆå¼€å‘ä¸­ï¼‰\n\n## Working Memory\n\nYou have access to persistent working memory that stores user preferences, context, and important facts across conversations.\n\n**ALWAYS call updateWorkingMemory when:**\n- User shares OR corrects their name, role, company, or preferences\n- User provides OR updates important facts you should remember\n- User corrects previous information about themselves\n- Any new or changed context that should persist for future conversations\n\n**Template structure to follow:**\n```\n# Working Memory\n\n## Key Facts\n- [Important information goes here]\n\n## Current Focus\n- [What the user is working on]\n\n## Preferences\n- [User preferences and settings]\n\n```\n\n**Critical:** After calling updateWorkingMemory, respond to the user confirming the update.",
  prompt: undefined,
  messages: [],
},
 vercel.ai.error: true,
 vercel.ai.error.AI_InvalidPromptError: true,

      at new _AISDKError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/@ai-sdk/provider/dist/index.mjs:19:5)

[Manager] Finished reading textStream. Total chunks: 0, Final text length: 0
[Manager] Final result received: {
  text: "N/A",
  textLength: 0,
  accumulatedLength: 0,
  usage: {
    input: undefined,
    output: undefined,
    total: undefined,
  },
}
[Manager] Query handled directly (no handoff): "[non-text message]"
[Manager] Returning final text (length=0)
ğŸ¯ [CardSuggestions] Finalizing card with follow-ups: cardId=7575067945618771147, contentLength=0
ğŸ¯ [CardSuggestions] Generating follow-up suggestions...
ğŸ”„ [Followups] Generating 3 follow-up questions for response: "..."
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
âŒ [WARN] Unhandled rejection at: Promise { <rejected> } reason: 14 |   constructor({
15 |     name: name14,
16 |     message,
17 |     cause
18 |   }) {
19 |     super(message);
         ^
AI_NoOutputGeneratedError: No output generated. Check the stream for errors.
      cause: undefined,
 vercel.ai.error: true,
 vercel.ai.error.AI_NoOutputGeneratedError: true,

      at new _AISDKError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/@ai-sdk/provider/dist/index.mjs:19:5)
      at new NoOutputGeneratedError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:249:5)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4772:27)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4769:19)
      at finalize (5:73)

âŒ [WARN] Unhandled rejection at: Promise { <rejected> } reason: 14 |   constructor({
15 |     name: name14,
16 |     message,
17 |     cause
18 |   }) {
19 |     super(message);
         ^
AI_NoOutputGeneratedError: No output generated. Check the stream for errors.
      cause: undefined,
 vercel.ai.error: true,
 vercel.ai.error.AI_NoOutputGeneratedError: true,

      at new _AISDKError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/@ai-sdk/provider/dist/index.mjs:19:5)
      at new NoOutputGeneratedError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:249:5)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4772:27)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4769:19)
      at finalize (5:73)

âŒ [WARN] Unhandled rejection at: Promise { <rejected> } reason: 14 |   constructor({
15 |     name: name14,
16 |     message,
17 |     cause
18 |   }) {
19 |     super(message);
         ^
AI_NoOutputGeneratedError: No output generated. Check the stream for errors.
      cause: undefined,
 vercel.ai.error: true,
 vercel.ai.error.AI_NoOutputGeneratedError: true,

      at new _AISDKError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/@ai-sdk/provider/dist/index.mjs:19:5)
      at new NoOutputGeneratedError (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:249:5)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4772:27)
      at flush (/Users/xiaofei.yin/work_repo/feishu_assistant/node_modules/ai/dist/index.mjs:4769:19)
      at finalize (5:73)

ğŸ”„ [Followups] LLM raw response (first 300 chars): "[
  {"text": "å¦‚ä½•æ•´ç†æœ‰æ•ˆçš„è¡Œä¸ºè®°å½•ï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®åˆ†ç±»ä¿å­˜å®¡æ ¸ææ–™", "type": "recommendation"},
  {"text": "ç«‹å³å¤‡ä»½è¿‘3ä¸ªæœˆè®°å½•", "type": "action"}
]..."
ğŸ”„ [Followups] Extracted JSON (first 200 chars): "[
  {"text": "å¦‚ä½•æ•´ç†æœ‰æ•ˆçš„è¡Œä¸ºè®°å½•ï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®åˆ†ç±»ä¿å­˜å®¡æ ¸ææ–™", "type": "recommendation"},
  {"text": "ç«‹å³å¤‡ä»½è¿‘3ä¸ªæœˆè®°å½•", "type": "action"}
]..."
âœ… [Followups] Generated 3 follow-up options with metadata
ğŸ¯ [CardSuggestions] generateFollowupQuestions returned 3 followups
ğŸ¯ [CardSuggestions] Formatting 3 suggestions as markdown...
ğŸ¯ [CardSuggestions] Updating card element with suggestions...
ğŸ”„ [Card] Updating card element: cardId=7575067945618771147, elementId=md_07946121, sequence=1, contentLength=128
âœ… [CardSuggestions] Card updated with 3 text-based suggestions
ğŸ¯ [CardSuggestions] Disabling streaming mode...
âœ… [CardSuggestions] Streaming mode disabled
ğŸ”˜ [CardSuggestions] Sending buttons in separate message (Hypothesis 1)...
ğŸ”˜ [FollowupButtons] Sending 3 buttons in separate message...
ğŸ”˜ [FollowupButtons] Creating card via CardKit...
ğŸ”˜ [FollowupButtons] Card created: 7575067982801407196
ğŸ”˜ [FollowupButtons] Sending as thread reply to rootId=om_x100b5d348cdd5c80c114f2bbe681419...
ğŸ”˜ [FollowupButtons] API response: {
  "code": 0,
  "data": {
    "body": {
      "content": "{\"title\":\"Suggestions\",\"elements\":[[{\"tag\":\"img\",\"image_key\":\"img_v3_02ad_e19fca1f-912a-450e-95de-3c229091b53g\"},{\"tag\":\"text\",\"text\":\"è¯·å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬å®¢æˆ·ç«¯ï¼Œä»¥æŸ¥çœ‹å†…å®¹\"},{\"tag\":\"text\",\"text\":\"\"}]]}"
    },
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "create_time": "1763707955587",
    "deleted": false,
    "message_id": "om_x100b5d348dfb8ca8c3c81c251ada75b",
    "msg_type": "interactive",
    "parent_id": "om...
ğŸ”˜ [FollowupButtons] isSuccess=true, code=0, has message_id=true
âœ… [FollowupButtons] Successfully sent buttons message: om_x100b5d348dfb8ca8c3c81c251ada75b
âœ… [CardSuggestions] Buttons sent in separate message: om_x100b5d348dfb8ca8c3c81c251ada75b
âœ… [ButtonFollowup] Button followup processed successfully
âœ… [CardAction] Button followup processed successfully
[error]: [
  [
    {
      message: "The socket connection was closed unexpectedly. For more information, pass `verbose: true` in the second argument to fetch()",
      config: [Object ...],
      request: [Object ...],
      response: [Object ...],
    }
  ]
]
[error]: [
  [
    {
      message: "The socket connection was closed unexpectedly. For more information, pass `verbose: true` in the second argument to fetch()",
      config: [Object ...],
      request: [Object ...],
      response: [Object ...],
    }
  ]
]
ğŸ“¨ [WebSocket] Event received: im.message.receive_v1
ğŸ“¨ [WebSocket] Event data: {
  "schema": "2.0",
  "event_id": "8be3cd1cde3797ac78d9b42c381ab268",
  "token": "",
  "create_time": "1763704291032",
  "event_type": "im.message.receive_v1",
  "tenant_key": "2de1f662118f575d",
  "app_id": "cli_a6af6b76c6f0d013",
  "message": {
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "chat_type": "group",
    "content": "{\"text\":\"@_user_1 new behavior check\"}",
    "create_time": "1763704290710",
    "mentions": [
      {
        "id": {
          "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
          "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
          "user_id": ""
        },
        "key": "@_user_1",
        "name": "Evi",
        "tenant_key": "2de1f662118f575d"
      }
    ],
    "message_id": "om_x100b5ecb90e42ca0c1140ac29f6c58b",
    "message_type": "text",
    "parent_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "root_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "thread_id": "omt_1a7b7fe7f08f1b85",
    "update_time": "1763704290789",
    "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 15_3_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.268 Safari/537.36 Lark/7.56.5 LarkLocale/zh_CN ttnet SDK-Version/7.56.19"
  },
  "sender": {
    "sender_id": {
      "open_id": "ou_db4d1d08c4fcd3f1f4c253eab32ff580",
      "union_id": "on_80d62273b85f0904e27382a59cc1f730",
      "user_id": "xiaofei.yin"
    },
    "sender_type": "user",
    "tenant_key": "2de1f662118f575d"
  }
}
ğŸ¤– [WebSocket] Bot User ID: cli_a6af6b76c6f0d013
ğŸ‘¤ [Auth] Extracted user ID: ou_db4d1d08c4fcd3f1f4c253eab32ff580
ğŸ“© [WebSocket] Message details: chatId=oc_cd4b98905e12ec0cb68adc529440e623, messageId=om_x100b5ecb90e42ca0c1140ac29f6c58b, chatType=group
ğŸ” [WebSocket] Mentions array: [
  {
    "id": {
      "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
      "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
      "user_id": ""
    },
    "key": "@_user_1",
    "name": "Evi",
    "tenant_key": "2de1f662118f575d"
  }
]
ğŸ” [WebSocket] Found 1 mention(s) in group message
âœ… [WebSocket] Bot mention detected via mentions array
ğŸ‘¥ [WebSocket] Processing group mention: "@_user_1 new behavior check..."
Handling app mention
ğŸ“¤ [Card] Creating and sending streaming card to chat_id:oc_cd4b98905e12ec0cb68adc529440e623
âœ… [Card] Created streaming card: cardId=7575069121927892182, elementId=md_08219922
ğŸ“¨ [Card] Sending card message with cardId: 7575069121927892182
ğŸ“¨ [Card] Sending as thread reply to message: om_x100b5ecb90e42ca0c1140ac29f6c58b
âœ… [Card] Card sent successfully: messageId=om_x100b5d349d05e478c2e9e45a0bbd0a0, cardId=7575069121927892182
[Thread] Fetching thread history: rootId=om_x100b5edb3c20e4a0c291114d498450e, messageId=om_x100b5ecb90e42ca0c1140ac29f6c58b
âŒ Failed to fetch thread after 1 attempt: Thread fetch timeout after 5000ms
âš ï¸ Proceeding with empty thread context (falling back to current message only)
âš ï¸ [Thread] Thread history empty or fetch failed, using current message only
[Thread] Fallback: Starting fresh with current message only
[Thread] Processing with 1 message(s)
[FeishuMention] Generating response...
[Manager] Received query: "@_user_1 new behavior check"
[Manager] Starting stream for query: "@_user_1 new behavior check" with primary model
[Manager] Memory context: conversationId=feishu:oc_cd4b98905e12ec0cb68adc529440e623:om_x100b5edb3c20e4a0c291114d498450e, userId=user:ou_db4d1d08c4fcd3f1f4c253eab32ff580, feishuUserId=ou_db4d1d08c4fcd3f1f4c253eab32ff580
[Manager] Stream created, starting to read textStream...
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=1, contentLength=1
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=2, contentLength=51
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=3, contentLength=103
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=4, contentLength=153
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=5, contentLength=207
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=6, contentLength=259
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=7, contentLength=314
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=8, contentLength=364
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=9, contentLength=414
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=10, contentLength=468
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=11, contentLength=518
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=12, contentLength=551
[Manager] Finished reading textStream. Total chunks: 114, Final text length: 551
[Manager] Final result received: {
  text: "N/A",
  textLength: 0,
  accumulatedLength: 551,
  usage: {
    input: undefined,
    output: undefined,
    total: undefined,
  },
}
[Manager] Query handled directly (no handoff): "@_user_1 new behavior check"
[Manager] Returning final text (length=551)
[FeishuMention] Response generated (length=551): "I notice you're mentioning "new behavior check" bu..."
[FeishuMention] Finalizing card with suggestions. cardId=7575069121927892182, result length=551
ğŸ¯ [CardSuggestions] Finalizing card with follow-ups: cardId=7575069121927892182, contentLength=551
ğŸ¯ [CardSuggestions] Generating follow-up suggestions...
ğŸ”„ [Followups] Generating 3 follow-up questions for response: "I notice you're mentioning "new behavior check" bu..."
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ”„ [Followups] LLM raw response (first 300 chars): "[
  {"text": "What specific behavior changes are you tracking?", "type": "question"},
  {"text": "Set up a structured OKR review process", "type": "recommendation"},
  {"text": "Share details with your team lead for alignment", "type": "action"}
]..."
ğŸ”„ [Followups] Extracted JSON (first 200 chars): "[
  {"text": "What specific behavior changes are you tracking?", "type": "question"},
  {"text": "Set up a structured OKR review process", "type": "recommendation"},
  {"text": "Share details with you..."
âœ… [Followups] Generated 3 follow-up options with metadata
ğŸ¯ [CardSuggestions] generateFollowupQuestions returned 3 followups
ğŸ¯ [CardSuggestions] Formatting 3 suggestions as markdown...
ğŸ¯ [CardSuggestions] Updating card element with suggestions...
ğŸ”„ [Card] Updating card element: cardId=7575069121927892182, elementId=md_08219922, sequence=13, contentLength=780
âœ… [CardSuggestions] Card updated with 3 text-based suggestions
ğŸ¯ [CardSuggestions] Disabling streaming mode...
âœ… [CardSuggestions] Streaming mode disabled
ğŸ”˜ [CardSuggestions] Sending buttons in separate message (Hypothesis 1)...
ğŸ”˜ [FollowupButtons] Sending 3 buttons in separate message...
ğŸ”˜ [FollowupButtons] Creating card via CardKit...
ğŸ”˜ [FollowupButtons] Card created: 7575069185630506204
ğŸ”˜ [FollowupButtons] Sending as thread reply to rootId=om_x100b5ecb90e42ca0c1140ac29f6c58b...
ğŸ”˜ [FollowupButtons] API response: {
  "code": 0,
  "data": {
    "body": {
      "content": "{\"title\":\"Suggestions\",\"elements\":[[{\"tag\":\"img\",\"image_key\":\"img_v3_02ad_e19fca1f-912a-450e-95de-3c229091b53g\"},{\"tag\":\"text\",\"text\":\"è¯·å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬å®¢æˆ·ç«¯ï¼Œä»¥æŸ¥çœ‹å†…å®¹\"},{\"tag\":\"text\",\"text\":\"\"}]]}"
    },
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "create_time": "1763708235279",
    "deleted": false,
    "message_id": "om_x100b5d349a7d088cc2beac1af20dd09",
    "msg_type": "interactive",
    "parent_id": "om...
ğŸ”˜ [FollowupButtons] isSuccess=true, code=0, has message_id=true
âœ… [FollowupButtons] Successfully sent buttons message: om_x100b5d349a7d088cc2beac1af20dd09
âœ… [CardSuggestions] Buttons sent in separate message: om_x100b5d349a7d088cc2beac1af20dd09
[FeishuMention] Card finalized with suggestions (buttons: om_x100b5d349a7d088cc2beac1af20dd09)
[error]: [
  [
    {
      message: "The socket connection was closed unexpectedly. For more information, pass `verbose: true` in the second argument to fetch()",
      config: [Object ...],
      request: [Object ...],
      response: [Object ...],
    }
  ]
]
ğŸ“¨ [WebSocket] Event received: im.message.receive_v1
ğŸ“¨ [WebSocket] Event data: {
  "schema": "2.0",
  "event_id": "6c181449e809be1d903c5ab64c2f72e7",
  "token": "",
  "create_time": "1763715605414",
  "event_type": "im.message.receive_v1",
  "tenant_key": "2de1f662118f575d",
  "app_id": "cli_a6af6b76c6f0d013",
  "message": {
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "chat_type": "group",
    "content": "{\"title\":\"\",\"content\":[[{\"tag\":\"at\",\"user_id\":\"@_user_1\",\"user_name\":\"Evi\",\"style\":[]},{\"tag\":\"text\",\"text\":\" \",\"style\":[]},{\"tag\":\"text\",\"text\":\"ç»™æˆ‘çœ‹ä¸‹11æœˆçš„OKRåˆ†æ\",\"style\":[]}]]}",
    "create_time": "1763715605026",
    "mentions": [
      {
        "id": {
          "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
          "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
          "user_id": ""
        },
        "key": "@_user_1",
        "name": "Evi",
        "tenant_key": "2de1f662118f575d"
      }
    ],
    "message_id": "om_x100b5d36ef800080c296c3490319e64",
    "message_type": "post",
    "parent_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "root_id": "om_x100b5edb3c20e4a0c291114d498450e",
    "thread_id": "omt_1a7b7fe7f08f1b85",
    "update_time": "1763715605115",
    "user_agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 15_3_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.6778.268 Safari/537.36 Lark/7.56.5 LarkLocale/zh_CN ttnet SDK-Version/7.56.19"
  },
  "sender": {
    "sender_id": {
      "open_id": "ou_db4d1d08c4fcd3f1f4c253eab32ff580",
      "union_id": "on_80d62273b85f0904e27382a59cc1f730",
      "user_id": "xiaofei.yin"
    },
    "sender_type": "user",
    "tenant_key": "2de1f662118f575d"
  }
}
ğŸ¤– [WebSocket] Bot User ID: cli_a6af6b76c6f0d013
ğŸ‘¤ [Auth] Extracted user ID: ou_db4d1d08c4fcd3f1f4c253eab32ff580
ğŸ“© [WebSocket] Message details: chatId=oc_cd4b98905e12ec0cb68adc529440e623, messageId=om_x100b5d36ef800080c296c3490319e64, chatType=group
ğŸ” [WebSocket] Mentions array: [
  {
    "id": {
      "open_id": "ou_b996baaafd4fd8f41d219ec7ad2af324",
      "union_id": "on_cb96bf8f32689f8c0b7415ad3a6b6d4e",
      "user_id": ""
    },
    "key": "@_user_1",
    "name": "Evi",
    "tenant_key": "2de1f662118f575d"
  }
]
ğŸ” [WebSocket] Found 1 mention(s) in group message
âœ… [WebSocket] Bot mention detected via mentions array
ğŸ‘¥ [WebSocket] Processing group mention: "..."
Handling app mention
ğŸ“¤ [Card] Creating and sending streaming card to chat_id:oc_cd4b98905e12ec0cb68adc529440e623
âœ… [Card] Created streaming card: cardId=7575100847010598095, elementId=md_15605737
ğŸ“¨ [Card] Sending card message with cardId: 7575100847010598095
ğŸ“¨ [Card] Sending as thread reply to message: om_x100b5d36ef800080c296c3490319e64
âœ… [Card] Card sent successfully: messageId=om_x100b5d36efa7bcbcc328123234242ea, cardId=7575100847010598095
[Thread] Fetching thread history: rootId=om_x100b5edb3c20e4a0c291114d498450e, messageId=om_x100b5d36ef800080c296c3490319e64
âŒ Failed to fetch thread after 1 attempt: Thread fetch timeout after 5000ms
âš ï¸ Proceeding with empty thread context (falling back to current message only)
âš ï¸ [Thread] Thread history empty or fetch failed, using current message only
[Thread] Fallback: Starting fresh with current message only
[Thread] Processing with 1 message(s)
[FeishuMention] Generating response...
[Manager] Received query: ""
[Manager] Starting stream for query: "" with primary model
[Manager] Memory context: conversationId=feishu:oc_cd4b98905e12ec0cb68adc529440e623:om_x100b5edb3c20e4a0c291114d498450e, userId=user:ou_db4d1d08c4fcd3f1f4c253eab32ff580, feishuUserId=ou_db4d1d08c4fcd3f1f4c253eab32ff580
[Manager] Stream created, starting to read textStream...
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=1, contentLength=2
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=2, contentLength=53
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=3, contentLength=104
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=4, contentLength=156
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=5, contentLength=206
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=6, contentLength=258
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=7, contentLength=308
[Manager] Finished reading textStream. Total chunks: 154, Final text length: 308
[Manager] Final result received: {
  text: "N/A",
  textLength: 0,
  accumulatedLength: 308,
  usage: {
    input: undefined,
    output: undefined,
    total: undefined,
  },
}
[Manager] Query handled directly (no handoff): ""
[Manager] Returning final text (length=308)
[FeishuMention] Response generated (length=308): "æ‚¨å¥½ï¼æˆ‘æ˜¯Feishu/Lark AIåŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å°†æŸ¥è¯¢è·¯ç”±åˆ°ç›¸åº”çš„ä¸“å®¶ä»£ç†ã€‚

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œ..."
[FeishuMention] Finalizing card with suggestions. cardId=7575100847010598095, result length=308
ğŸ¯ [CardSuggestions] Finalizing card with follow-ups: cardId=7575100847010598095, contentLength=308
ğŸ¯ [CardSuggestions] Generating follow-up suggestions...
ğŸ”„ [Followups] Generating 3 follow-up questions for response: "æ‚¨å¥½ï¼æˆ‘æ˜¯Feishu/Lark AIåŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å°†æŸ¥è¯¢è·¯ç”±åˆ°ç›¸åº”çš„ä¸“å®¶ä»£ç†ã€‚

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œ..."
ğŸ¤– [Model] Using primary model: kwaipilot/kat-coder-pro (Free tier (may have rate limits))
ğŸ”„ [Followups] LLM raw response (first 300 chars): "[
  {"text": "æ‚¨å¸Œæœ›è¯„ä¼°å“ªä¸ªå›¢é˜Ÿçš„OKRè¿›å±•ï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®å…ˆæ˜ç¡®ç›®æ ‡å¯¹é½å†åˆ¶å®šå…³é”®ç»“æœ", "type": "recommendation"},
  {"text": "ç‚¹å‡»è¿æ¥Alignment Agentç¡®è®¤ç›®æ ‡ä¸€è‡´æ€§", "type": "action"}
]..."
ğŸ”„ [Followups] Extracted JSON (first 200 chars): "[
  {"text": "æ‚¨å¸Œæœ›è¯„ä¼°å“ªä¸ªå›¢é˜Ÿçš„OKRè¿›å±•ï¼Ÿ", "type": "question"},
  {"text": "å»ºè®®å…ˆæ˜ç¡®ç›®æ ‡å¯¹é½å†åˆ¶å®šå…³é”®ç»“æœ", "type": "recommendation"},
  {"text": "ç‚¹å‡»è¿æ¥Alignment Agentç¡®è®¤ç›®æ ‡ä¸€è‡´æ€§", "type": "action"}
]..."
âœ… [Followups] Generated 3 follow-up options with metadata
ğŸ¯ [CardSuggestions] generateFollowupQuestions returned 3 followups
ğŸ¯ [CardSuggestions] Formatting 3 suggestions as markdown...
ğŸ¯ [CardSuggestions] Updating card element with suggestions...
ğŸ”„ [Card] Updating card element: cardId=7575100847010598095, elementId=md_15605737, sequence=8, contentLength=462
âœ… [CardSuggestions] Card updated with 3 text-based suggestions
ğŸ¯ [CardSuggestions] Disabling streaming mode...
âœ… [CardSuggestions] Streaming mode disabled
ğŸ”˜ [CardSuggestions] Sending buttons in separate message (Hypothesis 1)...
ğŸ”˜ [FollowupButtons] Sending 3 buttons in separate message...
ğŸ”˜ [FollowupButtons] Creating card via CardKit...
ğŸ”˜ [FollowupButtons] Card created: 7575100920033529037
ğŸ”˜ [FollowupButtons] Sending as thread reply to rootId=om_x100b5d36ef800080c296c3490319e64...
ğŸ”˜ [FollowupButtons] API response: {
  "code": 0,
  "data": {
    "body": {
      "content": "{\"title\":\"Suggestions\",\"elements\":[[{\"tag\":\"img\",\"image_key\":\"img_v3_02ad_e19fca1f-912a-450e-95de-3c229091b53g\"},{\"tag\":\"text\",\"text\":\"è¯·å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬å®¢æˆ·ç«¯ï¼Œä»¥æŸ¥çœ‹å†…å®¹\"},{\"tag\":\"text\",\"text\":\"\"}]]}"
    },
    "chat_id": "oc_cd4b98905e12ec0cb68adc529440e623",
    "create_time": "1763715623850",
    "deleted": false,
    "message_id": "om_x100b5d36ecb410acc2c4078884a41d0",
    "msg_type": "interactive",
    "parent_id": "om...
ğŸ”˜ [FollowupButtons] isSuccess=true, code=0, has message_id=true
âœ… [FollowupButtons] Successfully sent buttons message: om_x100b5d36ecb410acc2c4078884a41d0
âœ… [CardSuggestions] Buttons sent in separate message: om_x100b5d36ecb410acc2c4078884a41d0
[FeishuMention] Card finalized with suggestions (buttons: om_x100b5d36ecb410acc2c4078884a41d0)
âš ï¸ [WebSocket] Duplicate event ignored: 6c181449e809be1d903c5ab64c2f72e7
[error]: [
  [
    {
      message: "The socket connection was closed unexpectedly. For more information, pass `verbose: true` in the second argument to fetch()",
      config: [Object ...],
      request: [Object ...],
      response: [Object ...],
    }
  ]
]
